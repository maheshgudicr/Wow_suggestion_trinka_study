<!DOCTYPE html>
<html>

<head>

  <title>Survey</title>
  <script src="jspsych-6.1.0/jspsych.js"></script>
  <script src="jspsych-6.1.0/plugins//jspsych-fullscreen.js"></script>
  <script src="jspsych-6.1.0/plugins/jspsych-instructions.js"></script>
  <script src="jspsych-6.1.0/plugins/jspsych-survey-html-form.js"></script>
  <script src="jspsych-6.1.0/plugins/jspsych-survey-likert.js"></script>
  <script src="jspsych-6.1.0/plugins/jspsych-survey-text.js"></script>
  <script src="jspsych-6.1.0/plugins/jspsych-csv.js"></script>
  <script src="jspsych-6.1.0/bowser.js"></script>
  <script src="jspsych-6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
  <script src="jspsych-6.1.0/plugins/jspsych-html-button-response.js"></script>
  <script src="jspsych-6.1.0/plugins/jspsych-html-slider-response.js"></script>
  <script src = "jspsych-6.1.0/plugins/jspsych-image-keyboard-response.js"></script>
  <link href="jspsych-6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"></link>
  <style>
    img {
      width: 300px;
    }
    #display_stage {
       position: fixed;
       left: 0vw;
       top: 0vh;
       height: 100vh;
       width: 100vw;
       background-color: white;
       box-shadow: 1px 1px 1px #999;
       border-radius: 2px;
       z-index: 0;
       overflow-y: hidden;
       overflow-x: hidden;
   }
  </style>
  <div id='display_stage'></div>
</head>
<body></body>
<script>
  var fullscreen_trial = {
    type: 'fullscreen',
    message: "<p> This task will switch to full screen mode when you press the button below </p>",
    fullscreen_mode: true,
  };
  jsPsych.data.addProperties({ // add these variables to all rows of the datafile

      browser_name: bowser.name, browser_version: bowser.version,

      os_name: bowser.osname, os_version: bowser.osversion,

   // convert explicitly to string so that "undefined" (no response) does not lead to empty cells in the datafile
      screen_resolution: screen.width + ' x ' + screen.height,

      window_resolution: window.innerWidth + ' x ' + window.innerHeight, // this will be updated throughout the experiment
      window_width: window.innerWidth,
      window_height:window.innerHeight,
    });
  //console.log(screen.heigh  "screen height");
  var h = screen.height;
  var w = screen.width;
  var scale_w = w- 100;
  console.log(scale_w);
  var timeline = [];
  var welcome = {
    type: "survey-html-form",
    preamble: "<p> Welcome to the experiment, Please enter your name!</p>",
    html: "<p> Name: <input name = 'Part_ID' type: 'text'/></p>",
    choices: ["Click here to continue"],
    on_finish: function (data){
      data.responses = JSON.parse(data.responses);
      jsPsych.data.addProperties({
        Part_ID: data.responses.Part_ID,
      })
    }
  };
  var instructions = {
            type: 'instructions',
             pages: ['Welcome!, please rate the following  sentences'],
            show_clickable_nav: true
        };
  var fixation = {
            type: 'html-keyboard-response',
            stimulus: '<span style="font-size:40px;">+</span>',
            choices: jsPsych.NO_KEYS,
            trial_duration: 1000
        };
        

  var fullscreen_trial_exit = {
    type: 'fullscreen',
    fullscreen_mode: false
  };
 var end = {
     type: 'html-button-response',
     stimulus:[ 
     "<p> Thank you for your participation. </p> "+
     "<p> Please click  on <b>END</b> to complete. </p> " ],
     choices: ["END"],
   };
var trial = {
      type: 'html-slider-response',
      stimulus: jsPsych.timelineVariable('stimulus'),
      require_movement: true,
      labels: ['Dissatisfied' , 'Delighted']
  };
var trial_info = [
      {stimulus:`<div style="width:500px;">
          <p>S1: How likely are it that team A will win this match?</p>
          <p>S2: How likely is it that team A will win this match?</p>
          </div>`},
      {stimulus:`<div style="width:500px;">
          <p>S1: The paper and pencil sit idle in the desk.</p>
          <p>S2: The paper and pencil sat idle on the desk.</p>
          </div>`},
                
             ];
     
     var sentence_rating_procedure = {
                 timeline: [fixation,trial],
                 timeline_variables: trial_info,
                 randomize_order: true
             }

  jsPsych.init({
    timeline: [ fullscreen_trial, welcome, instructions,sentence_rating_procedure, fullscreen_trial_exit],
      display_element: 'display_stage',
    on_finish: function() {
      jsPsych.data.displayData();
      var id = jsPsych.data.get().last(1).values()[0].Part_ID;
      //jsPsych.data.get.localSave('csv', id  +'.csv')
      jsPsych.data.get().localSave('csv','mydata.csv');
      saveData(id, selected_data.csv());

    }
  });
  
 
</script>

</html>